<polymer-element name="optime-card">
  <template>
    <style>
      :host {
        margin: 20px auto;
        width: auto;
        display: inline;
        font-family: Calibri;
        font-size: 1.2em;

        transition: height 0.5s ease-in-out,margin-top 0.5s ease-in-out, margin-bottom 0.5s ease-in-out;
      }

      paper-shadow {
        height: auto;
        display: block;
        box-sizing: border-box;
        border: none;
        background-color: white;
        color: black;
        padding: 20px;
        border-radius: 2px;

        width: 390px;
        transform: translate(0,0) scale(0,0);
        opacity: 0;
      }

      ::content h1 {
        color: #999;
        margin-top: 0;
        font-weight: normal;
        font-family: Courier;
      }

      :host([wide])::shadow paper-shadow {
        width: 800px;
        padding: 40px;
      }

      :host([optime-status='shown'])::shadow paper-shadow {
        transition: transform 0.5s ease-out, opacity 0.5s ease-out;
        transform: translate(0,0) scale(1,1);
        opacity: 1;
      }
      :host([optime-status='dismissed'])::shadow paper-shadow {
        transition: transform 0.5s ease-in, opacity 0.5s ease-in;
        transform: translate(100px,0) scale(1,1);
        opacity: 0;
      }

      :host([optime-status='hidden']) {
        height: 0;
        margin-top: 0px;
        margin-bottom: 0px;
      }

    </style>
    <paper-shadow id="container" z='{{z}}'>
      <content></content>
      <div horizontal layout reverse>
        <template bind="{{acceptAction as acceptAction}}" if="{{acceptable}}">
          <paper-button on-tap="{{acceptAction}}">{{acceptText}}</paper-button>
        </template>
        <template bind="{{dismissAction as dismissAction}}" if="{{dismissable}}">
          <paper-button on-tap="{{dismissAction}}">{{dismissText}}</paper-button>
        </template>
      </div>
    </paper-shadow>
  </template>
  <script>
    Polymer({
      z: 1,
      acceptText: "Accept",
      dismissText: "Dismiss",
      acceptable: false,
      dismissable: false,
      dismissAction: function(e) {
        if(this.transitionMethod) this.transitionMethod.teardown(this);
        else this.style.opacity="0";
      },
      acceptAction: function(e) {},
      ready: function() {
        this.acceptable=this.hasAttribute("acceptable");
        this.dismissable=this.hasAttribute("dismissable");

        var meta = document.createElement('core-meta');
        meta.type='transition';
        var transition = meta.byId("optime-card-fade");
        this.transitionMethod=transition;

        this.transitionMethod.setup(this);

        if(this.hasAttribute("optime-auto-load"))
          this.transitionMethod.go(this);
      },
      getInnerHeight: function() {
        var cont=$(this.shadowRoot).children("paper-shadow");
        return window.getComputedStyle(cont[0]).height;
      }
    });
  </script>
</polymer-element>
